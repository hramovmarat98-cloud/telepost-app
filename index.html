<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Telepost Mini App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background: #f4f7fa; padding: 15px; }
    .tab-content { display: none; }
    .active { display: block !important; }
    .btn { margin: 5px 0; }
    .chat-msg { padding: 10px; margin: 8px 0; border-radius: 12px; max-width: 80%; }
    .user { background: #d1e7dd; margin-left: auto; text-align: right; }
    .bot { background: #f8f9fa; margin-right: auto; border: 1px solid #dee2e6; }
  </style>
</head>
<body>
  <h1>üì± Telepost</h1>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
  <div class="btn-group w-100 mb-3" role="group">
    <button class="btn btn-outline-primary" onclick="showTab('chat')">üí¨ –ß–∞—Ç</button>
    <button class="btn btn-outline-primary" onclick="showTab('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    <button class="btn btn-outline-primary" onclick="showTab('analytics')">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞: –ß–∞—Ç -->
  <div id="chat" class="tab-content active">
    <div id="chat-history" style="height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 8px; background: white;">
      <div class="chat-msg bot">–ü—Ä–∏–≤–µ—Ç! –Ø ‚Äî –≤–∞—à –∫–æ–Ω—Ç–µ–Ω—Ç-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –ß—Ç–æ –±—É–¥–µ–º –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å?</div>
    </div>
    <div class="input-group mt-2">
      <input type="text" id="user-input" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="handleEnter(event)">
      <button class="btn btn-primary" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
  <div id="settings" class="tab-content">
    <div class="card">
      <div class="card-body">
        <h5>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º</h5>
        <button class="btn btn-success w-100" onclick="sendCommand('üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞')">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å</button>
        <button class="btn btn-danger w-100 mt-2" onclick="sendCommand('üõë –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞')">üõë –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
        <button class="btn btn-info w-100 mt-2" onclick="sendCommand('üìù –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥')">üìù –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥</button>
      </div>
    </div>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
  <div id="analytics" class="tab-content">
    <div class="card">
      <div class="card-body">
        <h5>üìä –ê–Ω–∞–ª–∏–∑ –∫–∞–Ω–∞–ª–∞</h5>
        <p><strong>üîπ –¢–æ–ø —Ç–µ–º:</strong> –ò–ò, –º–æ—Ç–∏–≤–∞—Ü–∏—è, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</p>
        <p><strong>üîπ –°–∞–º—ã–π –≤–æ–≤–ª–µ—á—ë–Ω–Ω—ã–π –ø–æ—Å—Ç:</strong> "–ö–∞–∫ –ò–ò –º–µ–Ω—è–µ—Ç –º–∏—Ä"</p>
        <p><strong>üîπ –°–æ–≤–µ—Ç –æ—Ç –ò–ò:</strong> –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –≤–∏–¥–µ–æ ‚Äî –∞—É–¥–∏—Ç–æ—Ä–∏—è –ª—é–±–∏—Ç –≤–∏–∑—É–∞–ª</p>
      </div>
    </div>
  </div>

  <script>
    const WebApp = window.Telegram?.WebApp;
    WebApp.ready();

    // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω
    const BOT_TOKEN = "8543978687:AAGkHidnWB31Ysi8Bw-MDqrv9ZpWcSnyGcw";
    const CHAT_ID = WebApp.initDataUnsafe?.user?.id || "123456789";

    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
    }

    function sendMessage() {
      const input = document.getElementById("user-input");
      const text = input.value.trim();
      if (!text) return;

      const chat = document.getElementById("chat-history");
      const userMsg = document.createElement("div");
      userMsg.className = "chat-msg user";
      userMsg.textContent = text;
      chat.appendChild(userMsg);
      chat.scrollTop = chat.scrollHeight;

      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±–æ—Ç—É
      fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ chat_id: CHAT_ID, text: "üí¨ –Æ–∑–µ—Ä: " + text })
      });

      input.value = "";
    }

    function sendCommand(cmd) {
      fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ chat_id: CHAT_ID, text: cmd })
      }).then(() => {
        alert("‚úÖ –ö–æ–º–∞–Ω–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞: " + cmd);
      });
    }

    function handleEnter(e) {
      if (e.key === "Enter") sendMessage();
    }
  </script>
</body>
</html>
